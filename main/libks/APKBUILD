# Contributor: Francesco Colista <fcolista@alpinelinux.org>
# Maintainer: Francesco Colista <fcolista@alpinelinux.org>
pkgname=libks
pkgver=1.7.0
pkgrel=0
pkgdesc="Foundational support for signalwire C products"
url="https://github.com/signalwire/libks"
arch="all"
license="MIT"
makedepends="cmake util-linux-dev openssl-dev"
subpackages="$pkgname-dev $pkgname-doc"
source="$pkgname-$pkgver.tar.gz::https://github.com/signalwire/libks/archive/refs/tags/v$pkgver.tar.gz
disable-failing-tests.patch"

build() {
	cmake \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX:PATH=/usr \
	.
	make
}

check() {
	ctest
}

package() {
	make DESTDIR="$pkgdir" install
}

sha512sums="
d5e1244f1c42b22684cb342d6007dd6ed84f39466631d1fb198e4d57e374a8014a957bae74f2ea62cfdc8824564f21c417e984101640d938fc12471f4ffcc2cc  libks-1.7.0.tar.gz
07511475d3cbbae3d68c5fa7b0d993c0c2fb593f9d0e62265c31db840ceea9ad66b6ec50c8200695a20b51858cb52bf5f40ebd82ff9f328360fda03d183ab7ed  disable-failing-tests.patch
"
